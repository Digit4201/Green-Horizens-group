document.addEventListener('DOMContentLoaded',()=>{const e=document.body,t=document.querySelector('.navbar'),o=document.querySelector('.menu-toggle'),n=document.querySelector('.nav-menu'),a=document.querySelectorAll('.stat-number'),c=document.querySelector('.process-timeline'),r=document.querySelector('.scroll-to-top'),i=document.getElementById('cookie-banner'),s=document.getElementById('contact-modal');const l=(e,t)=>{let o;return(...n)=>{clearTimeout(o),o=setTimeout(()=>e.apply(this,n),t)}};const d=()=>{const t=document.querySelector('.photo-overlay');t&&t.addEventListener('animationend',()=>e.classList.add('overlay-hidden'),{once:!0})},m=()=>{o&&n&&(o.addEventListener('click',()=>{const t='true'===o.getAttribute('aria-expanded');o.setAttribute('aria-expanded',!t),n.classList.toggle('active'),o.classList.toggle('active'),e.classList.toggle('menu-open')}))},p=()=>{if(!s)return;const e=document.querySelectorAll('.open-modal-btn'),t=document.querySelectorAll('.modal-close-btn');const o=()=>s.classList.add('visible'),n=()=>s.classList.remove('visible');e.forEach(e=>e.addEventListener('click',e=>{e.preventDefault(),o()})),t.forEach(e=>e.addEventListener('click',n)),s.addEventListener('click',e=>{e.target===s&&n()}),document.addEventListener('keydown',e=>{'Escape'===e.key&&s.classList.contains('visible')&&n()})},u=()=>{if(!i)return;const e=i.querySelector('.cookie-accept-btn');if(localStorage.getItem('cookiesAccepted'))return;setTimeout(()=>i.classList.add('visible'),2e3),e&&e.addEventListener('click',()=>{localStorage.setItem('cookiesAccepted','true'),i.classList.remove('visible')})},v=()=>{if(!c)return;const e=c.querySelector('.timeline-progress'),t=c.querySelectorAll('.timeline-item');const o=()=>{if(c.classList.contains('is-hovered'))return;const t=c.getBoundingClientRect();e.style.height=`${Math.min(1,Math.max(0,(window.scrollY-(c.offsetTop-.8*window.innerHeight))/(c.offsetHeight-.5*window.innerHeight)))*100}%`};t.forEach(t=>{const n=t.querySelector('.timeline-marker');t.addEventListener('mouseenter',()=>{c.classList.add('is-hovered');const o=t.offsetTop+n.offsetHeight/2;e.style.height=`${o}px`})}),c.addEventListener('mouseleave',()=>{c.classList.remove('is-hovered'),o()}),window.addEventListener('scroll',o)},h=()=>{document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener('click',function(t){if(!this.classList.contains('open-modal-btn')){t.preventDefault();const e=document.querySelector(this.getAttribute('href'));e&&e.scrollIntoView({behavior:'smooth',block:'start'})}})}),r&&r.addEventListener('click',()=>window.scrollTo({top:0,behavior:'smooth'}))},g=()=>{const e=window.scrollY,o=document.querySelectorAll('section[id], header[id]'),n=document.querySelectorAll('.nav-menu a'),a=document.querySelectorAll('.float-element');t&&t.classList.toggle('scrolled',e>50),a.forEach((t,o)=>{const n=.3+.1*o;t.style.transform=`translateY(${e*-n}px)`}),r&&r.classList.toggle('visible',e>300);let c='';o.forEach(e=>{const t=e.getBoundingClientRect();t.top<=.2*window.innerHeight&&t.bottom>=.2*window.innerHeight&&(c=e.getAttribute('id'))}),n.forEach(e=>{e.classList.remove('active');const t=e.getAttribute('data-section');t&&t===c&&e.classList.add('active')})},f=()=>{const e=document.querySelectorAll('.fade-in');const t=e=>{const o=+e.getAttribute('data-target'),n=2e3,a=16.666666666666668,c=Math.round(n/a);let r=0;const i=setInterval(()=>{r++;const n=r/c,s=Math.round(o*n);e.textContent=s>0?`${s}`:`-${Math.abs(s)}`,r===c&&(clearInterval(i),e.textContent=o>0?`${o}`:`-${Math.abs(o)}`)},a)};const o=new IntersectionObserver((n,a)=>{n.forEach(n=>{n.isIntersecting&&(n.target.classList.add('visible'),n.target.matches('.stat-number')&&t(n.target),a.unobserve(n.target))})},{threshold:.1,rootMargin:'0px 0px -50px 0px'});e.forEach(e=>o.observe(e)),a.forEach(e=>o.observe(e))};d(),m(),p(),u(),v(),h(),f(),window.addEventListener('scroll',l(g,10))});